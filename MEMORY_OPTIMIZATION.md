# Оптимизация памяти для сервера с 1 ГБ RAM

## Анализ потребления памяти

### Текущее потребление (оценка):

1. **Python интерпретатор**: ~30-50 МБ
2. **Библиотеки (aiogram, pandas, numpy)**: ~100-150 МБ
3. **Кэш файлов в памяти** (TTL 120 минут):
   - Текущие файлы: ~0.2 МБ
   - Потенциально: до 5-10 файлов × ~200 КБ = 1-2 МБ
4. **SQLite база данных**: ~50-100 КБ (очень маленькая)
5. **Обработка Excel файлов** (временное):
   - pandas при загрузке файла: может потребовать 3-5× размер файла
   - Для файла 200 КБ: ~600 КБ - 1 МБ временно
6. **Резерв для системы**: ~200-300 МБ

**Итого: ~400-600 МБ в нормальном режиме**

## Проблемные моменты

### ⚠️ Потенциальные проблемы:

1. **Pandas и NumPy** могут потреблять много памяти при обработке больших файлов
2. **Кэш в памяти** хранит полные файлы (TTL 120 минут)
3. **Одновременная обработка** нескольких запросов может удвоить потребление
4. **Пиковая нагрузка** может достигать 800 МБ - 1 ГБ

## Рекомендации по оптимизации

### 1. Уменьшить TTL кэша в памяти

Текущий TTL: 120 минут (2 часа)
Рекомендуемый: 30-60 минут

### 2. Добавить ограничение на размер кэша

Ограничить количество файлов в кэше памяти

### 3. Использовать более эффективные настройки pandas

Отключить неиспользуемые функции pandas

### 4. Мониторинг памяти

Добавить логирование использования памяти

## Реализация оптимизаций

